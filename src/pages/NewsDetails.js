import React, { useEffect } from "react";
import Head from "next/head";
import Link from "next/link";
import Image from "next/image";
import Header from "@/components/Header";
import Footer from "@/components/Footer";
import { NewsData } from "@/content/data";
import Banner from "../assets/images/news-banner.jpg";
import { LatestNewsSection } from "../pages/news";
import { Box, Grid, Stack, Typography } from "@mui/material";
import { useFetch } from "./api/api";
import { useRouter } from "next/router";
import quoteIcon from "../assets/icons/quoteicon.png";
import Loader from "@/components/Loader";

export default function NewsDetails() {
  const router = useRouter();
  const query = router.query;

  console.log(query.apiURl)

  const { fetchAPI, data, isLoading } = useFetch(
    "get",
    `${query.apiURl}/${query.id}`
  );


  useEffect(() => {
    fetchAPI();
  }, [fetchAPI]);

  const News = {};
  if (data?.data) {
    const { description, newsName, url, publicMeetingName } = data?.data;
    News.description = description;
    News.newsName = newsName || publicMeetingName;
    News.url = url;
  }

  return (
    <>
      <Head>
        <title>Media</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.png" />
      </Head>

      {/*-----------------------Header---------------------*/}

      <Header />

      {/*-----------------------Banner---------------------*/}

      <section>
        <Image src={Banner} alt="..." className="h-96 w-full" />
      </section>

      {/*-----------------------Detailed News---------------------*/}
      {isLoading ? (
        <Loader />
      ) : (
        <section>
          <Grid container>
            {/* LEFT SIDE START */}
            {data?.data && (
              <Grid item xs={8} sx={{ marginTop: "8rem" }}>
                <Stack
                  sx={{
                    flexDirection: "column",
                    margin: {
                      xs: "0px 5rem 4rem 6rem",
                      md: "0px 5rem 4rem 2rem",
                      lg: "0px 5rem 4rem 6rem",
                      xl: "0px 5rem 4rem 15rem",
                    },
                    width: { xs: "85%", md: "90%", lg: "78%", xl: "70%" },
                    gap: "2rem",
                  }}
                >
                  <Box sx={{ width: "100%", height: "450px" }}>
                    {/* eslint-disable-next-line @next/next/no-img-element */}
                    <img
                      src={News.url}
                      alt={News.newsName}
                      style={{
                        width: "100%",
                        height: "100%",
                        objectFit: "cover",
                      }}
                    />
                  </Box>
                  <Typography variant="body1" sx={{ color: "grey" }}>
                    {News.newsName}
                  </Typography>
                  <Stack sx={{ flexDirection: "column", gap: "1.5rem" }}>
                    <Typography
                      variant="body1"
                      sx={{ fontWeight: "400", fontSize: "2rem" }}
                    >
                      {News.newsName}
                    </Typography>
                    <Typography variant="subtitle1" sx={{ color: "grey" }}>
                      {News.newsName}
                    </Typography>
                    <Typography variant="subtitle1" sx={{ color: "grey" }}>
                      {News.newsName}
                    </Typography>

                    <Stack
                      sx={{
                        background: "#F9F6F0",
                        wordSpacing: "0.2rem",
                        fontWeight: "600",
                        p: "2rem 1rem",
                        position: "relative",
                        height: "130px",
                        textAlign: "center",
                      }}
                    >
                      <Image
                        src={quoteIcon}
                        style={{
                          width: "50px",
                          height: "50px",
                          position: "absolute",
                          top: "5px",
                          left: "0",
                          display: "block",
                        }}
                        alt="quote_icon"
                      />
                      <Stack
                        sx={{ flexDirection: "column", alignItems: "start" }}
                      >
                        <Typography
                          variant="inherit"
                          sx={{ textIndent: "3rem" }}
                        >
                          The Eswatini Revenue Service (ERS) is a
                          semi-autonomous revenue administration agency,
                          established through the Revenue Authority Act No. 1 of
                          2008.
                        </Typography>
                        <Typography
                          variant="subtitle1"
                          sx={{
                            textIndent: "4.8rem",
                            textTransform: "uppercase",
                            color: "#f4c402",
                          }}
                        >
                          - ERS
                        </Typography>
                      </Stack>
                    </Stack>
                    <Typography
                      variant="body1"
                      sx={{ color: "grey" }}
                      dangerouslySetInnerHTML={{ __html: News.description }}
                    ></Typography>
                    <Typography variant="body1"></Typography>
                  </Stack>
                </Stack>
              </Grid>
            )}

            {/* Right Side with latest news*/}
            <LatestNewsSection />
            {/* Right Side End */}
          </Grid>
        </section>
      )}

      {/*-----------------------Footer---------------------*/}

      <Footer />
    </>
  );
}
